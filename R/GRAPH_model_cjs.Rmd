---
title: "R Notebook"
output: 
  html_notebook: 
    fig_width: 16
    toc_depth: 5
---

```{r}
print(CJS_0)
autocorr.plot(CJS_0, ask = F)
traceplot(CJS_0, ask = F)
```

```{r}
print(CJS_1)
autocorr.plot(CJS_1, ask = F)
traceplot(CJS_1, ask = F)
```


```{r}
print(CJS_treatment)
autocorr.plot(CJS_treatment, ask = F)
traceplot(CJS_treatment, ask = F)
```

```{r}
print(CJS_treatment_age)
autocorr.plot(CJS_treatment_age, ask = F)
traceplot(CJS_treatment_age, ask = F)
```
```{r}

tbl = data.frame()
for (i in 1:4){
  for (j in 1:6){
    x = as.mcmc(CJS_treatment_age)[[1]][,paste("phi[", as.character(i), ",", as.character(j), "]", sep = "")]
    tbl <- rbind(tbl,data.frame(x,i,j))
  }
}

colnames(tbl) <- c("phi","Treatment","Age")
tbl <- tbl %>% mutate(Treatment = factor(Treatment)) %>% mutate(Age = factor(Age))

ggplot(tbl)+
  geom_density(aes( x = phi, color = Treatment))+
  facet_wrap(~ Age)

ggplot(tbl)+
  geom_boxplot(aes( y = phi, color = Age))

ggplot(tbl)+
  geom_density(aes( x = phi, color = Age))+
  facet_wrap(~ Treatment)

tbl = data.frame()
for (i in 1:5){
  x = as.mcmc(CJS_treatment_age)[[1]][,paste("p[", as.character(i),"]", sep = "")]
  tbl <- rbind(tbl,data.frame(x,i))
}

colnames(tbl) <- c("p","Age")
tbl <- tbl %>% mutate(Age = factor(Age))


ggplot(tbl)+
  geom_density(aes( x = p, color = Age))

ggplot(tbl)+
  geom_boxplot(aes(y = p, color = Age))
```


```{r}
print(CJS_treatment_maturity)
autocorr.plot(CJS_treatment_maturity, ask = F)
traceplot(CJS_treatment_maturity, ask = F)
```

```{r}
tbl = data.frame()
for (i in 1:4){
  for (j in 1:2){
    x = as.mcmc(CJS_treatment_maturity)[[1]][,paste("phim[", as.character(i), ",", as.character(j), "]", sep = "")]
    tbl <- rbind(tbl,data.frame(x,i,j))
  }
}

colnames(tbl) <- c("phi","Treatment","Maturity")
tbl <- tbl %>% mutate(Treatment = factor(Treatment)) %>% mutate(Maturity = factor(Maturity))

ggplot(tbl)+
  geom_density(aes( x = phi, color = Treatment))+
  facet_wrap(~ Maturity)

ggplot(tbl)+
  geom_density(aes( x = phi, color = Maturity))+
  facet_wrap(~ Treatment)

tbl = data.frame()
for (j in 1:2){
    x = as.mcmc(CJS_treatment_maturity)[[1]][,paste("pm[", as.character(j), "]", sep = "")]
    tbl <- rbind(tbl,data.frame(x,j))
}

colnames(tbl) <- c("p","Maturity")

tbl <- tbl %>% mutate(Maturity = factor(Maturity))

ggplot(tbl)+
  geom_density(aes( x = p, color = Maturity))

```

```{r}
print(CJS_taille)
autocorr.plot(CJS_taille, ask = F)
traceplot(CJS_taille, ask = F)
```

```{r}

taille <- BDD_a$Size
p <- 1/(1+exp(-0.003*taille))
phi <- invlogit(0.003*taille+1)
df = data.frame(taille,phi,p)

ggplot(df)+
  geom_point(aes(x = taille, y = phi))+
  geom_point(aes(x = taille, y = p), color = "red")

```


```{r}
print(CJS_2)
autocorr.plot(CJS_2, ask = F)
traceplot(CJS_2, ask = F)
```

```{r}
print(CJS_3)
autocorr.plot(CJS_3, ask = F)
traceplot(CJS_3, ask = F)
```

















